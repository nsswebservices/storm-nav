!function(t,e){"object"==typeof exports?module.exports=e():t.StormNav=e()}(this,function(){"use strict";function t(t,e){var s=document.querySelector(t);return 0===s.length||s.length>1?void console.warn("Nav element must match a single DOM node"):Object.assign(Object.create(n),{DOMElement:s,settings:Object.assign({},i,e)}).init()}var e={RETURN:13,TAB:9},s=["click","keydown","touchstart"],i={tabSelector:".js-nav-tab",titleSelector:".js-nav-title",closeBtnSelector:".js-nav-close",currentClass:"active",active:null},n={init:function(){return this.tabs=[].slice.call(this.DOMElement.querySelectorAll(this.settings.tabSelector)),this.titles=[].slice.call(this.DOMElement.querySelectorAll(this.settings.titleSelector)),this.triggers=this.titles.concat(this.tabs),this.targets=this.tabs.map(function(t){return document.getElementById(t.getAttribute("href").substr(1))||console.error("No subnav elements not found")}),this.closeBtn=this.DOMElement.querySelector(this.settings.closeBtnSelector),this.current=this.settings.active,this.initAria(),!!this.tabs.length&&this.initTriggers(this.tabs),!!this.titles.length&&this.initTriggers(this.titles),!!this.current&&this.openTab(this.current),!!this.closeBtn&&this.initCloseBtn(),this},initAria:function(){return this.triggers.forEach(function(t){STORM.UTILS.attributelist.set(t,{role:"tab",tabIndex:0,"aria-expanded":!1,"aria-selected":!1,"aria-controls":t.getAttribute("href")?t.getAttribute("href").substr(1):t.parentNode.getAttribute("id")})}),this.targets.forEach(function(t){STORM.UTILS.attributelist.set(t,{role:"tabpanel","aria-hidden":!0,tabIndex:"-1"})}),this},initCloseBtn:function(){s.forEach(function(t){this.closeBtn.addEventListener(t,function(t){t.stopImmediatePropagation(),null!==this.current&&this.toggle(this.current)}.bind(this),!1)}.bind(this))},initTriggers:function(t){var i=function(t){this.toggle(t)};return t.forEach(function(t,n){s.forEach(function(s){t.addEventListener(s,function(t){t.keyCode&&t.keyCode===e.TAB||t.keyCode&&t.keyCode!==e.RETURN||(t.preventDefault(),i.call(this,n))}.bind(this),!1)}.bind(this))}.bind(this)),this},changeTab:function(t,e){var s={open:{classlist:"add",tabIndex:{target:this.targets[e],value:"0"}},close:{classlist:"remove",tabIndex:{target:this.targets[this.current],value:"-1"}}};this.tabs[e].classList[s[t].classlist](this.settings.currentClass),this.titles[e].classList[s[t].classlist](this.settings.currentClass),this.targets[e].classList[s[t].classlist](this.settings.currentClass),STORM.UTILS.attributelist.toggle(this.targets[e],"aria-hidden"),STORM.UTILS.attributelist.toggle(this.tabs[e],["aria-selected","aria-expanded"]),STORM.UTILS.attributelist.toggle(this.titles[e],["aria-selected","aria-expanded"]),STORM.UTILS.attributelist.set(s[t].tabIndex.target,{tabIndex:s[t].tabIndex.value})},openTab:function(t){return this.changeTab("open",t),this.current=t,this},closeTab:function(t){return this.changeTab("close",t),this},toggle:function(t){return this.current===t?(this.closeTab(this.current),this.current=null,this):null===this.current?(this.openTab(t),this):(this.closeTab(this.current).openTab(t),this)},open:function(t){},close:function(t){}};return{init:t}});